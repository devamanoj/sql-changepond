select o1.orderNumber,o1.status,
    -> sum(quantityordered*priceeach) total
    -> from orders o1
    -> inner join orderdetails o2
    -> on o1.ordernumber=o2.ordernumber
    -> group by o1.ordernumber;

select ordernumber,
orderdate,
productname,
quantityordered,
customername,
priceeach
from orders
inner join orderdetails using(orderNumber)
inner join products using(productcode)
inner join customers using(customernumber)
where customername like 'A%'
and quantityordered>50



select c.customernumber,
customername,
ordernumber,
status
from customers c
left join orders o
on c.customernumber=o.customernumber
order by ordernumber desc;

select c.customernumber,
customername,
ordernumber,
status
from customers c
left join orders o
on c.customernumber=o.customernumber
where ordernumber is null
order by ordernumber desc;

select c.customernumber,
customername,
ordernumber,
status
from customers c
left join orders o
on c.customernumber=o.customernumber
where ordernumber=10123;

select c.customernumber,
customername,
ordernumber,
status
from customers c
left join orders o
on c.customernumber=o.customernumber
and ordernumber=10123
limit 10;

select c.customernumber,
customername,
ordernumber,
status
from customers c
left join orders o
on c.customernumber=o.customernumber


select employeenumber,customernumber
from customers
right join employees
on salesrepemployeenumber=employeenumber

select concat(m.lastname,"",m.firstname) "manager",
concat(e.lastname,"",e.firstname) "employee"
from
employees e
inner join
employees m on
m.employeenumber =e.reportsto
order by manager

select concat(m.lastname,"",m.firstname) "manager",
concat(e.lastname,"",e.firstname) "employee"
from
employees e
left join
employees m on
m.employeenumber =e.reportsto
order by manager
select lastname,firstname from employees
where officecode in(
                    select officecode from offices
                    where country ='USA') 
select lastname,firstname from employees
where officecode in(
                    select officecode from offices
                    where country ='USA') 

select * from payments
where amount=(
              select max(amount) from payments);
select * from payments
where amount<(
              select max(amount) from payments);
select * from payments
where amount>(
              select max(amount) from payments);
select c.customernumber,
customername,
ordernumber,
status
from customers c
left join orders o
on c.customernumber=o.customernumber
where ordernumber is null

select customername from customers
where customernumber not in (
                             select distinct customernumber
                             from orders)

select ordernumber,count(ordernumber) as items
from orderdetails group by ordernumber

select max(items),
min(items),avg(items) from
(select ordernumber,count(ordernumber) as items
from orderdetails group by ordernumber) as lineitems

 select productname,buyprice,productline
    -> from products p1
    -> where buyprice>(
    -> select avg(buyprice) from products
    -> where productline=p1.productline
    -> )
    -> order by productline;
+-----------------------------------------+----------+------------------+
| productname                             | buyprice | productline      |
+-----------------------------------------+----------+------------------+
| 1952 Alpine Renault 1300                |    98.58 | Classic Cars     |
| 1998 Chrysler Plymouth Prowler          |   101.51 | Classic Cars     |
| 1992 Ferrari 360 Spider red             |    77.90 | Classic Cars     |
| 1972 Alfa Romeo GTA                     |    85.68 | Classic Cars     |
| 1962 LanciaA Delta 16V                  |   103.42 | Classic Cars     |
| 1968 Ford Mustang                       |    95.34 | Classic Cars     |
| 2001 Ferrari Enzo                       |    95.59 | Classic Cars     |
| 1957 Corvette Convertible               |    69.93 | Classic Cars     |
| 1970 Triumph Spitfire                   |    91.92 | Classic Cars     |
| 1969 Corvair Monza                      |    89.14 | Classic Cars     |
| 1968 Dodge Charger                      |    75.16 | Classic Cars     |
| 1969 Ford Falcon                        |    83.05 | Classic Cars     |
| 1976 Ford Gran Torino                   |    73.49 | Classic Cars     |
| 1993 Mazda RX-7                         |    83.51 | Classic Cars     |
| 1952 Citroen-15CV                       |    72.82 | Classic Cars     |
| 1965 Aston Martin DB5                   |    65.96 | Classic Cars     |
| 1956 Porsche 356A Coupe                 |    98.30 | Classic Cars     |
| 1992 Porsche Cayenne Turbo Silver       |    69.78 | Classic Cars     |
| 1995 Honda Civic                        |    93.89 | Classic Cars     |
| 1996 Moto Guzzi 1100i                   |    68.99 | Motorcycles      |
| 2003 Harley-Davidson Eagle Drag Bike    |    91.02 | Motorcycles      |
| 2002 Suzuki XREO                        |    66.27 | Motorcycles      |
| 1997 BMW R 1100 S                       |    60.86 | Motorcycles      |
| 1997 BMW F650 ST                        |    66.92 | Motorcycles      |
| 1974 Ducati 350 Mk3 Desmo               |    56.13 | Motorcycles      |
| 1928 British Royal Navy Airplane        |    66.74 | Planes           |
| 1980s Black Hawk Helicopter             |    77.27 | Planes           |
| American Airlines: B767-300             |    51.15 | Planes           |
| America West Airlines B757-200          |    68.80 | Planes           |
| ATA: B757-300                           |    59.33 | Planes           |
| F/A 18 Hornet 1/72                      |    54.40 | Planes           |
| 1999 Yamaha Speed Boat                  |    51.61 | Ships            |
| The Queen Mary                          |    53.63 | Ships            |
| 18th century schooner                   |    82.34 | Ships            |
| The Titanic                             |    51.09 | Ships            |
| Collectable Wooden Train                |    67.56 | Trains           |
| 1962 Volkswagen Microbus                |    61.34 | Trucks and Buses |
| 1940 Ford Pickup Truck                  |    58.33 | Trucks and Buses |
| 1964 Mercedes Tour Bus                  |    74.86 | Trucks and Buses |
| Diamond T620 Semi-Skirted Tanker        |    68.29 | Trucks and Buses |
| 1940s Ford truck                        |    84.76 | Trucks and Buses |
| 1958 Setra Bus                          |    77.90 | Trucks and Buses |
| 1913 Ford Model T Speedster             |    60.78 | Vintage Cars     |
| 1904 Buick Runabout                     |    52.66 | Vintage Cars     |
| 1903 Ford Model A                       |    68.30 | Vintage Cars     |
| 1936 Chrysler Airflow                   |    57.46 | Vintage Cars     |
| 1928 Mercedes-Benz SSK                  |    72.56 | Vintage Cars     |
| 1917 Grand Touring Sedan                |    86.70 | Vintage Cars     |
| 1932 Model A Ford J-Coupe               |    58.48 | Vintage Cars     |
| 1937 Lincoln Berline                    |    60.62 | Vintage Cars     |
| 1917 Maxwell Touring Car                |    57.54 | Vintage Cars     |
| 18th Century Vintage Horse Carriage     |    60.74 | Vintage Cars     |
| 1941 Chevrolet Special Deluxe Cabriolet |    64.58 | Vintage Cars     |
| 1912 Ford Model T Delivery Wagon        |    46.91 | Vintage Cars     |
| 1940 Ford Delivery Sedan                |    48.64 | Vintage Cars     |
+-----------------------------------------+----------+------------------+
55 rows in set (0.01 sec)



select customername,customernumber from customers
where exists
(
select ordernumber,sum(priceeach*quantityordered) total
from orderdetails
inner join orders using (orderNumber)
where customernumber = customers.customernumber
group by ordernumber
having sum(priceeach*quantityordered) >6000)

select customernumber,
round(sum(quantityordered*priceeach))sales,
(case
     when sum(quantityordered*priceeach) < 10000 then 'silver'
     when sum(quantityordered*priceeach) between 10000 and 100000 then 'gold'
     when sum(quantityordered*priceeach) > 100000 then 'platinum'
     end ) customergroup
from 
orderdetails inner join orders using (ordernumber)
where year(shippeddate) =2003
group by customernumber
order by sales desc
limit 10

select customername,sales,customergroup from
(select customernumber,
round(sum(quantityordered*priceeach))sales,
(case
     when sum(quantityordered*priceeach) < 10000 then 'silver'
     when sum(quantityordered*priceeach) between 10000 and 100000 then 'gold'
     when sum(quantityordered*priceeach) > 100000 then 'platinum'
     end ) customergroup
from 
orderdetails inner join orders using (ordernumber)
where year(shippeddate) =2003
group by customernumber
order by sales desc
limit 10) top20customers2003
inner join customers using (customernumber)


delete from tasks 

rollback

truncate

select concat(first_name," ",last_name) fullname from employee;

select upper concat(first_name," ",last_name) fullname from employee;

select length(trim(productname)),productname,substr(productname,3,4) from products limit 10;


